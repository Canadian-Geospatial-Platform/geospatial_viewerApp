<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Responsive sidebar template with sliding effect and dropdown menu based on bootstrap 3">
    <title>Sidebar template</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" rel="stylesheet">
    <link href="style_sidebar.css" rel="stylesheet">
      <link href="plugins/Leaflet-EaziButtons/src/leaflet-EaziButtons.css" rel="stylesheet">
        <link href="plugins/Leaflet-Pancontrol/src/L.Control.Pan.css" rel="stylesheet">
        <link href="plugins/Leaflet-Draw/src/leaflet.draw.css" rel="stylesheet">

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.css"
  integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
  crossorigin=""/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" rel="stylesheet">
</head>
<body>
<div class="page-wrapper chiller-theme toggled">
  <a id="show-sidebar" class="btn btn-sm btn-dark" href="#">
    <i class="fas fa-bars"></i>
  </a>
  <nav id="sidebar" class="sidebar-wrapper">
    <div class="sidebar-content">
      <div class="sidebar-brand">
        <a href="#"></a>
        <div id="close-sidebar">
          <i class="fas fa-times"></i>
        </div>
      </div>
      <div class="sidebar-header">
        <!-- <div class="user-pic">
          <img class="img-responsive img-rounded" src="https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg"
            alt="User picture">
        </div>
        <div class="user-info">
          <span class="user-name">name
            <strong>place</strong>
          </span>
          <span class="user-role"></span>
          <span class="user-status">
            <i class="fa fa-circle"></i>
            <span> </span>
          </span>

        </div> -->
        <h5 style="color:white">Geospatial Viewer Map</h5>
      </div>
      <!-- aqu comienza -->
       <div class="container">
      <div class="row">
                <div class="col-xs-12">
                  <nav>
                    <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                      <a class="nav-item nav-link  active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Basic Map</a>
                      <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Edit</a>
                    </div>
                  </nav>
                  <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                      <br>
                      <!-- <div class="sidebar-search"> -->
                        <select id="locality-dropdown" class="dropdown" name="locality">
                        </select>
                        <div>
                        </div>
                        <br>
                            <div class="form-group">
                                <div class="dropdown">
                                  <button class="btn _select_color dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Green
                                    <span _text_display="Green" class="color green"></span></button>
                            <ul class="dropdown-menu _select_color_drop" aria-labelledby="dropdownMenu1">
                            <li><span _text_display="Green" class="color green"></span></li>
                            <li><span _text_display="Red" class="color red"></span></li>
                            <li><span _text_display="Yellow" class="color yellow"></span></li>
                            <li><span _text_display="Brown" class="color brown"></span></li>
                            <li><span _text_display="Orange" class="color orange"></span></li>
                            <li><span _text_display="Pink" class="color pink"></span></li>
                            <li><span _text_display="Silver" class="color silver"></span></li>
                            <li><span _text_display="Bule" class="color blue"></span></li>
                            <li><span _text_display="TEAL" class="color TEAL"></span></li>
                            <li><span _text_display="NAVY" class="color NAVY"></span></li>
                            <li><span _text_display="PURPLE" class="color PURPLE"></span></li>
                            <li><span _text_display="OLIVE" class="color OLIVE"></span></li>
                            <li><span _text_display="LIME" class="color LIME"></span></li>
                        <input type="hidden" name="_color" value="Green"></ul>
                        </div>
                      </div>
                    <!-- </div>
                 </div> -->
                      <div class="sidebar-menu">
                        <ul>
                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="fa fa-database"></i>
                              <span>Dataset</span>
                            </a>
                            <div class="sidebar-submenu">
                              <ul>
                                <li>
                                <label class="radio">(2017/05/03)
                                  <input type="radio" checked="checked" name="is_company">
                                  <span class="checkround"></span>
                                </label>
                               </li>
                               <li>
                               <label class="radio">(2014/09/03)
                                 <input type="radio" checked="checked" name="is_company">
                                 <span class="checkround"></span>
                               </label>
                              </li>
                              </ul>
                            </div>
                          </li>
                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="far fa-gem"></i>
                              <span>Layers</span>
                            </a>
                            <div class="sidebar-submenu">
                              <ul>
                                 <li>
<label class="check ">Electrical towers
  <input type="checkbox" checked="checked" name="is_name">
<span class="checkmark"></span>
</label>
</li>
<li>
<label class="check">Oil wells
  <input type="checkbox"  name="is_name">
<span class="checkmark"></span>
</label>
</li>
<li>
<label class="check ">Higway
  <input type="checkbox"  name="is_name">
<span class="checkmark"></span>
</label>
</li>
<li>
<label class="check ">Pipe line
  <input type="checkbox"  name="is_name">
<span class="checkmark"></span>
</label>
</li>


                              </ul>
                            </div>
                          </li>

                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="fa fa-globe"></i>
                              <span>Maps</span>
                            </a>
                            <div class="sidebar-submenu">
                              <ul>
                                <li>
                                <label class="radio">Topographic Map
                                  <input type="radio" checked="checked" class="clickmap" id="1" value="Topographic"  name="is_company">
                                  <span class="checkround"></span>
                                </label>
                               </li>
                               <li>
                               <label class="radio">Streets Map
                                 <input type="radio" checked="checked"  class="clickmap" id="2" value="Streets"  name="is_company">
                                 <span class="checkround"></span>
                               </label>
                              </li>

                                <li>
                                  <label class="radio">National Geographic Map
                                    <input type="radio" checked="checked"  class="clickmap" id="3" value="NationalGeographic"  name="is_company">
                                    <span class="checkround"></span>
                                  </label>
                                </li>
                                <li>
                                  <label class="radio">Oceans Map
                                    <input type="radio" checked="checked" class="clickmap" id="4" value="Oceans"  name="is_company">
                                    <span class="checkround"></span>
                                  </label>
                                </li>
                                <li>
                                  <label class="radio">Physical  Map
                                    <input type="radio" checked="checked" class="clickmap" id="5" value="Physical" name="is_company">
                                    <span class="checkround"></span>
                                  </label>
                                </li>
                                <li>
                                  <label class="radio">Imagery  Map
                                    <input type="radio" checked="checked" class="clickmap" id="6" value="Imagery" name="is_company">
                                    <span class="checkround"></span>
                                  </label>
                                </li>
                              </ul>
                            </div>
                          </li>

                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="fa fa-file-export"></i>
                              <span>Export to</span>
                            </a>
                            <div class="sidebar-submenu">
                              <ul>
                                <li>
                                <label class="radio">Image
                                  <input type="radio" checked="checked" class="clickexport" id="exportpng" value="1"  name="clickexport">
                                  <span class="checkround"></span>
                                </label>
                               </li>
                               <li>
                               <label class="radio">XML
                                 <input type="radio" checked="checked"  class="clickexport" id="exportxml" value="2"  name="clickexport">
                                 <span class="checkround"></span>
                               </label>
                              </li>
                               <li>
                              <label class="radio">GeoJson
                                <input type="radio" checked="checked"  class="clickexport" id="exportgeojson" value="3"  name="clickexport">
                                <span class="checkround"></span>
                              </label>
                             </li>
                             <li>
                            <label class="radio">PDF Format
                              <input type="radio" checked="checked"  class="clickexport" id="exportgeojson" value="4"  name="clickexport">
                              <span class="checkround"></span>
                            </label>
                           </li>
                              </ul>

                                <div class="col-md-4">
                              <button class="btn btn-round-xs btn-xs mr-2 mb-2 btn-icon btn-outline-primary" id="btnexport" >
                                <span class="btn-inner-icon"><i class="fa fa-file-export"></i></span>
                                <span class="btn-inner-text">Apply</span>
                              </button>
                            </div>

                            </div>

                            </li>
                          </ul>

                      </div>

                    </div>
                    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                      <div class="sidebar-menu">
                        <ul>
                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="fa fa-draw-polygon"></i><span>Drawing</span>
                            </a>
                            <div class="sidebar-submenu center">

                                  <button  class="btn  btn-sm cust-btn btn-outline-danger" type="button" id="btn-drawLine" name="btndrawline" value="DrawLine">Draw Line</button>

                                  <button  class="btn  btn-sm cust-btn btn-outline-danger" type="button" id="btn-drawPolygon" name="btndrawpolygon" value="DrawPolygon">Draw Polygon</button>

                                  <button  class="btn  btn-sm cust-btn btn-outline-danger" type="button" id="btn-drawCircle" name="btndrawcircle" value="DrawCircle">Draw Circle</button>

                                  <button type="button" class="btn btn-sm cust-btn btn-outline-danger">Edit Draw Shape</button>

                            </div>
                          </li>
                          <li class="sidebar-dropdown">
                            <a href="#">
                              <i class="fa fa-info"></i>
                              <span>Boundary Info</span>
                            </a>
                            <div class="sidebar-submenu">
                                <ul>
                                  <li>
                                    <label class="radio">Postal Code
                                      <input type="radio" checked="checked" name="is_company">
                                      <span class="checkround"></span>
                                    </label>
                                  </li>
                                  <li>
                                    <label class="radio">Place cities
                                      <input type="radio" checked="checked" name="is_company">
                                      <span class="checkround"></span>
                                    </label>
                                  </li>
                                  <li>
                                    <label class="radio">Parkings
                                      <input type="radio" checked="checked" name="is_company">
                                      <span class="checkround"></span>
                                    </label>
                                  </li>
                                  <li>
                                    <label class="radio">Military Base
                                      <input type="radio" checked="checked" name="is_company">
                                      <span class="checkround"></span>
                                    </label>
                                  </li>
                                </ul>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div><!-- row -->


          </div> <!-- container -->
      <!-- aqui termina -->
      <!-- sidebar-header  -->

      <!-- sidebar-search  -->


      <!-- sidebar-menu  -->
    </div>
    <!-- sidebar-content  -->
    <div class="sidebar-footer">
      <!-- <button class="btn mr-2 mb-2 btn-icon-only btn-outline-primary" type="button">
                 <span class="btn-inner-icon"><i class="fa fa-file-export"></i></span>
             </button>
      <a href="#">
        <i class="fa fa-envelope"></i>
        <span class="badge badge-pill badge-success notification">7</span>
      </a>
      <a href="#">
        <i class="fa fa-cog"></i>
        <span class="badge-sonar"></span>
      </a>
      <a href="#">
        <i class="fa fa-power-off"></i>
      </a> -->
    </div>
  </nav>
  <!-- sidebar-wrapper  -->
  <main class="page-content">
    <div class="container-fluid">
      <h2>Canadian Territory Map</h2>
      <hr>
      <div class="row">
        <div class="form-group col-md-12">
          <div id="mymapid">
            <!-- <div class="btn-group d-flex justify-content-center" style="z-index: 1001">
              <button type="buttons" id="allbus" class="btn btn-success">All</button>
              <button type="buttons" id="others" class="btn btn-primary">Others</button>
              <button type="buttons" id="cafes" class="btn btn-danger">Cafes</button>
 </div>
            </div> -->
        </div>
        <!-- <div class="form-group col-md-12">
          <iframe src="https://ghbtns.com/github-btn.html?user=azouaoui-med&repo=pro-sidebar-template&type=star&count=true&size=large"
            frameborder="0" scrolling="0" width="140px" height="30px"></iframe>
          <iframe src="https://ghbtns.com/github-btn.html?user=azouaoui-med&repo=pro-sidebar-template&type=fork&count=true&size=large"
            frameborder="0" scrolling="0" width="140px" height="30px"></iframe>
        </div> -->
      </div>

    </div>

  </main>
  <!-- page-content" -->
</div>
<div id='snapshot'></div>
<canvas id="myCanvas"  width="5" height="5" ></canvas>
<!-- page-wrapper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.js"
        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
        crossorigin=""></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
        <script src="plugins/leaflet-search/src/leaflet-search.js"></script>
        <script src="plugins/Leaflet-EaziButtons/src/leaflet-EaziButtons.js"></script>
        <script src="plugins/Leaflet-Pancontrol/src/L.Control.Pan.js"></script>
        <script src="plugins/Leaflet.Icon.Glyph/Leaflet.Icon.Glyph.js"></script>
        <!-- <script src="plugins/Leaflet-Draw/src/Leaflet.draw.js"></script> -->
        <script src="plugins/leaflet-eazyprinter/bundle.js"></script>
        <!-- <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-image/v0.0.4/leaflet-image.js'></script> -->
          <!-- <script src="plugins/Leaflet-Draw/src/Toolbar.js"></script> -->
            <!-- <script src="plugins/Leaflet-Draw/src/Tooltip.js"></script> -->
            <!-- <script src="plugins/Leaflet-Draw/src/Control.Draw.js"></script> -->
          <!-- <script src="plugins/Leaflet-Draw/src/Leaflet.Draw.Event.js"></script> -->
          <!-- <script src="plugins/Leaflet-Draw/src/draw/handler/Draw.Polyline.js"></script> -->
        <!--   <script src="plugins/Leaflet-Image/leaflet-image.js"></script>-->
          <script src="Data/canada.js" type="text/javascript"></script>
          <script src="https://unpkg.com/leaflet-image@latest/leaflet-image.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha256-DupmmuWppxPjtcG83ndhh/32A9xDMRFYkGOVzvpfSIk=" crossorigin="anonymous"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js" integrity="sha256-gJWdmuCRBovJMD9D/TVdo4TIK8u5Sti11764sZT1DhI=" crossorigin="anonymous"></script>
  <script>L_PREFER_CANVAS = true</script>
        <script src="Data/e.js" type="text/javascript"></script>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
        <script src="https://unpkg.com/esri-leaflet@2.3.3/dist/esri-leaflet.js"
        integrity="sha512-cMQ5e58BDuu1pr9BQ/eGRn6HaR6Olh0ofcHFWe5XesdCITVuSBiBZZbhCijBe5ya238f/zMMRYIMIIg1jxv4sQ=="
        crossorigin=""></script>
<script type="text/javascript">
var snapshot = document.getElementById('snapshot');

//var context = canvas.getContext('2d');
  var val_zoom=4;

  jQuery(function ($) {

    var printer = L.easyPrint({
      		tileLayer: tiles,
      		sizeModes: ['Current'],
      		filename: 'myMap',
      		exportOnly: true,
          hidden:true,
      		hideControlContainer: true
		}).addTo(mymap);

    // function doImage(err, canvas){
    //   var img = document.createElement('img');
    //     var dimensions = mymap.getSize();
    //     img.width = dimensions.x;
    //     img.height = dimensions.y;
    //     console.log(canvas);
    //     img.src = canvas.toDataURL();
    //    snapshot.innerHTML = '';
    //    snapshot.appendChild(img);
    // }

      var arr=[];
    $(".sidebar-dropdown > a").click(function() {
  $(".sidebar-submenu").slideUp(200);
  if (
    $(this)
      .parent()
      .hasClass("active")
  ) {
    $(".sidebar-dropdown").removeClass("active");
    $(this)
      .parent()
      .removeClass("active");
  } else {
    $(".sidebar-dropdown").removeClass("active");
    $(this)
      .next(".sidebar-submenu")
      .slideDown(200);
    $(this)
      .parent()
      .addClass("active");
  }
});

$("#close-sidebar").click(function() {
  $(".page-wrapper").removeClass("toggled");
});
$("#show-sidebar").click(function() {
  $(".page-wrapper").addClass("toggled");
});
let dropdown = $('#locality-dropdown');

dropdown.empty();

dropdown.append('<option selected="true" disabled>Choose State/Province</option>');
dropdown.prop('selectedIndex', 0);

const url = 'https://api.myjson.com/bins/7xq2x';
const url1='https://api.myjson.com/bins/xz1dc';
const url2='https://api.myjson.com/bins/1akrv0';

// Populate dropdown with list of provinces
// $.getJSON(url1,function (data) {
//     var i=0;
//   $.each(data, function (key, entry) {
//
//     $.each(entry,function(v,j){
//
//       console.log(j[i]);
//       console.log(i);
//       i=i+1;
//     });
//
//   });
// });

$.getJSON(url2, function (data) {
  $.each(data, function (key, entry) {
    //console.log(entry);
    dropdown.append($('<option></option>').attr('value', entry.short).text(entry.name));
  })
});

  $('#locality-dropdown').change(
    function() {

        //var val1 = $('#pick option:selected').val(); $('#locality-dropdown option:selected').val();
        var val2 = this.value;
        console.log(val2);
        $.getJSON(url2, function (data) {
        $.each(data, function(i, v) {
            if (v.short == val2) {
                //alert(v.latitude + " " + " "+ v.longitude  );
                var position=new L.LatLng(v.latitude, v.longitude )
                //L.marker(position).addTo(map);
                var greenIcon = new L.Icon({
                    iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                  });

                  if (arr.length===0)  {
                             arr.push(position);
                             //console.log(arr);
                             console.log(arr.length);
                  }
                  else {
                    var k=arr.pop();
                    console.log(k);
                    arr.push(position);
                    console.log(position);
                     markers(k,v);

                  }
                L.marker(position, {icon: greenIcon}).addTo(mymap);
                mymap.flyTo(position,4);
                return;
            }
        });
          });
        // Do something with val1 and val2 ...
    });

    $(".clickmap").click(function(){
      //if (this.id==1)
      var layer;
      var layerLabels;
      if (layer) {
        mymap.removeLayer(layer);
      }
      layer = L.esri.basemapLayer(this.value).addTo(mymap);
      // if (layerLabels) {
      //   map.removeLayer(layerLabels);
      // }
      console.log(this.value);
    });
function markers(k,v){
  var marker=L.marker(k, {icon: L.icon.glyph({ prefix: 'glyphicon', glyph: 'adjust' }) }).addTo(mymap);
  console.log(v);
  marker.bindPopup('<p align=center>' + '<strong>Short: </strong>'+  v.short + '<br/>' + '<strong>Province: </strong>' + v.capital + '<br/>' + '<strong>Population: </strong>' + v.population);
  return marker
};
// Define you draw handler somewhere where you click handler can access it. N.B. pass any draw options into the handler
  var polylineDrawer = new L.Draw.Polyline(mymap);

// Assumming you have a Leaflet map accessible
mymap.on('draw:created', function (e) {
    var type = e.layerType,
        layer = e.layer;
    layer.addTo(mymap);
  });

// Click handler for you button to start drawing polygons
// $('#draw_poly').click(function() {
//
// });
$(".btn-outline-danger").click(function(){
$(this).addClass('focus').siblings().removeClass('focus');
  $("#btn-drawLine").click(function(){

    // var polyline = new L.Draw.Polyline(mymap, {
    //   shapeOptions: {
    //     color: '#181616'
    //   }
    // });
  //  var polylineDrawer = new L.Draw.Polyline(mymap);
      polylineDrawer.enable();
  })
  console.log(this.value);
  $("#btn-drawPolygon").click(function() {
    //$(this).addClass('focus');
    var polygonDrawer = new L.Draw.Polygon(mymap);
      polygonDrawer.enable();
  });

  $("#btn-drawCircle").click(function() {
    var circleDrawer = new L.Draw.Circle(mymap);
      circleDrawer.enable();

  });
});

function downloadMap(err, canvas) {
    // var imgData = canvas.toDataURL("image/jpeg", 1.0);
    // var dimensions = mymap.getSize();
    // //var pdf = new jsPDF('l', 'pt', 'letter');
    // var pdf = new jsPDF();
    // pdf.addImage(imgData, 'PNG', 10, 10, dimensions.x * 0.5, dimensions.y * 0.5);
    // //pdf.addImage(imgData, 'PNG',10, 10);
    // //cover.className = '';
    // pdf.save("mymapdownloaded.pdf");
    var imgData = canvas.toDataURL("image/svg+xml", 1.0);
         var dimensions = mymap.getSize();

         var pdf = new jsPDF('l', 'pt', 'letter');
         pdf.addImage(imgData, 'PNG', 10, 10, dimensions.x * 0.5, dimensions.y * 0.5);

         cover.className = '';

         pdf.save("download.pdf");
  };

$('#btnexport').click(function(){
  var radioValue = $("input[name='clickexport']:checked").val();
  if (radioValue==1) {
    //export map to an image
     printer.printMap('CurrentSize', 'MyManualPrint')
      // leafletImage(mymap, downloadMap);
  }
  if (radioValue==4) {
    //export to pdf
      //leafletImage(mymap, downloadMap);
      //  var imgData = document.createElement('img');
      var canvas = document.getElementById('myCanvas');
          imgData = canvas.toDataURL("image/svg+xml",1.0);
          //var dataURL = canvas.toDataURL();

        var dimensions = mymap.getSize();
        //var pdf = new jsPDF('p', 'mm');
        var pdf = new jsPDF('l', 'pt', 'letter');
        pdf.addImage(imgData, 'PNG', 10, 10, dimensions.x * 0.5, dimensions.y * 0.5);
        //pdf.addImage(imgData, 'JPG',0, 0);
      //  pdf.addImage(imgData, 'PNG', 10, 10);
        //snapshot.appendChild(imgData);
      //  cover.className = '';
//  console.log(imgData);
  console.log(pdf);
        pdf.save("samplefile.pdf");
  }
  console.log(radioValue);
});
});//end jQuery


const attribution='&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors';



var tiles=L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?',{attribution});

var mapOptions = {
            center: [55.585901, -105.750596],
            zoom: 4,

            zoomControl: false
         }
         var mymap = new L.map('mymapid', mapOptions); // Creating a map object


 L.control.zoom({
      maxZoom: 18,
      position:'topright'
 }).addTo(mymap);
    L.control.scale({
      position:'topleft'
    }).addTo(mymap);
 //console.log(mymap.getZoom());
//mymap.setZoom(mymap.getZoom() + val_zoom);


//--------------------------------
// var MyCustomMarker = L.Icon.extend({
//   options: {
//     shadowUrl: null,
//     iconAnchor: new L.Point(12, 12),
//     iconSize: new L.Point(24, 24),
//     iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/6/6b/Information_icon4_orange.svg'
//   }
// });
//
// // Initialise the FeatureGroup to store editable layers
// var editableLayers = new L.FeatureGroup();
// mymap.addLayer(editableLayers);
//
// var drawPluginOptions = {
//   position: 'topleft',
//   draw: {
//     polyline: {
//       shapeOptions: {
//         color: '#f357a1',
//         weight: 10
//       }
//     },
//     polygon: {
//       allowIntersection: false, // Restricts shapes to simple polygons
//       drawError: {
//         color: '#e1e100', // Color the shape will turn when intersects
//         message: '<strong>Polygon draw does not allow intersections!<strong> (allowIntersection: false)' // Message that will show when intersect
//       },
//       shapeOptions: {
//         color: '#bada55'
//       }
//     },
//     circle: false, // Turns off this drawing tool
//     rectangle: {
//       shapeOptions: {
//         clickable: false
//       }
//     },
//     marker: {
//       icon: new MyCustomMarker()
//     }
//   },
//   edit: {
//     featureGroup: editableLayers, //REQUIRED!!
//     remove: false
//   }
// };





// Initialise the draw control and pass it the FeatureGroup of editable layers


// var drawControl = new L.Control.Draw(drawPluginOptions);
// mymap.addControl(drawControl);
//
//
// var editableLayers = new L.FeatureGroup();
// mymap.addLayer(editableLayers);
// mymap.on('draw:created', function(e) {
//   var type = e.layerType,
//     layer = e.layer;
//
//   if (type === 'marker') {
//     layer.bindPopup('A popup!');
//   }
//
//   editableLayers.addLayer(layer);
// });





//---------------------------------
 tiles.addTo(mymap);
 L.control.pan({
   position:'topright'
 }).addTo(mymap);
 var textLatLng = [65.585901,-105.750596];
         var myTextLabel = L.marker(textLatLng, {
             icon: L.divIcon({
                 className: 'text-labels',   // Set class for CSS styling
                 html: 'Canadian Territorry'
             }),
             zIndexOffset: 1000     // Make appear above other map features
         });


          L.easyButton('fa-arrows-alt', function()
          {
          mymap.setView([55.585901, -105.750596],4);
          }).addTo(mymap);

myTextLabel.addTo(mymap);

function getColor(d) {
  return d > 1000 ? '#800026' :
         d > 500  ? '#BD0026' :
         d > 200  ? '#E31A1C' :
         d > 100  ? '#FC4E2A' :
         d > 50   ? '#FD8D3C' :
         d > 20   ? '#FEB24C' :
         d > 10   ? '#FED976' :
                    '#FFEDA0';
}
function style(feature) {
  return {
      fillColor: getColor(feature.properties.rank),
      weight: 2,
      opacity: 1,
      color: 'white',
      dashArray: '3',
      fillOpacity: 0.7
  };
}
L.geoJson(CanData, {style:style}).addTo(mymap);

function highlightFeature(e) {
  var layer = e.target;
  layer.setStyle({
      weight: 5,
      color: '#F78181',
      dashArray: '',
      fillOpacity: 0.3
  });
  if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
      layer.bringToFront();
  }
}
function resetHighlight(e) {
  geojson.resetStyle(e.target);
}
function zoomToFeature(e) {
  mymap.fitBounds(e.target.getBounds());
}
function onEachFeature(feature, layer) {
  layer.on({
      mouseover: highlightFeature,
      mouseout: resetHighlight,
      click: zoomToFeature
  });
}

geojson = L.geoJson(CanData, {
  style: style,
  onEachFeature: onEachFeature
}).addTo(mymap);



var myLayer = L.geoJSON(ProvData);
myLayer.addData(ProvData).addTo(mymap);



var geojsonMarkerOptions = {
 radius: 10,
 fillColor: "#67363A",
 color: "#000",
 weight: 1,
 opacity: 1,
 fillOpacity: 0.8
};
//mymap.zoomControl.remove();
var featuresLayer = new L.geoJSON(ProvData, {
  pointToLayer: function (feature, latlng) {
    //console.log(latlng);
     var ciclemarker=  L.circleMarker(latlng,geojsonMarkerOptions).addTo(mymap);
     var marker=L.marker(latlng, {icon: L.icon.glyph({ prefix: 'glyphicon', glyph: 'adjust' }) }).addTo(mymap);
    marker.bindPopup('<p align=center>' + '<strong>Short: </strong>'+  feature.properties.short + '<br/>' + '<strong>Province: </strong>' + feature.properties.Name + '<br/>' + '<strong>Population: </strong>' + feature.properties.population);
    return marker;
  }
});

var color="#1E0602"
var searchControl = new L.Control.Search({
  layer: featuresLayer,
  propertyName: 'Name',
  position:'topleft',
  initial: false,
  zoom: 12,
  marker: false,
  moveToLocation: function(layer,latlng,  mymap) {
    //map.fitBounds( latlng.layer.getBounds() );
    //var zoom = mymap.getBoundsZoom(layer.getBounds());
    //layer.getBounds();

    //console.log(layer.feature);
      //mymap.setView(latlng, 12); // access the zoom

      marker = new L.Marker(new L.latLng(latlng) );//se property searched
  //marker.bindPopup('title: '+ title );
  featuresLayer.addLayer(marker);
  }
});

searchControl.on('search:locationfound', function(e) {

  //console.log('search:locationfound', );

  //map.removeLayer(this._markerSearch)

  e.layer.setStyle({fillColor: '#3f0', color: '#0f0'});
  if(e.layer._popup)
    e.layer.openPopup();

}).on('search:collapsed', function(e) {
  featuresLayer.eachLayer(function(layer) {	//restore feature color
    featuresLayer.resetStyle(layer);
  });
});

mymap.addControl( searchControl );  //inizialize search control

_colors=$('._select_color_drop li');
    for (var i = _colors.length - 1; i >= 0; i--) {
        $(_colors[i]).click(function(){
            var color_text = $(this).find('span').attr('_text_display');
            var elemnt = $(this).closest('._select_color_drop').prev();
            elemnt.find('span.color').remove();
            $(this).find('span').clone().appendTo(elemnt);
            var contents = $(elemnt).contents();
            if (contents.length > 0) {
                if (contents.get(0).nodeType == Node.TEXT_NODE) {
                    $(elemnt).html(color_text).append(contents.slice(1));
                }
            }
            if($('[name=_color]').val() == undefined){
                elemnt.next().append("<input type='hidden' name='_color' value='"+color_text+"'>");
            }else{
                $('[name=_color]').val(color_text);
            }

        })
    };


</script>
</body>

</html>
